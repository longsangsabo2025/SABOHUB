<!DOCTYPE html>
<html>
<head>
    <title>Test SABOHUB Signup Flow</title>
    <script>
        // Test script Ä‘á»ƒ check signup flow
        async function testSignupFlow() {
            console.log('ğŸ§ª Báº¯t Ä‘áº§u test signup flow...');
            
            // Wait for page to load
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            try {
                // Try to find signup elements
                const signupButton = document.querySelector('[data-testid="signup-button"]') || 
                                   document.querySelector('button:contains("ÄÄƒng kÃ½")') ||
                                   document.querySelector('button:contains("Sign Up")') ||
                                   document.querySelector('a[href*="signup"]');
                
                if (signupButton) {
                    console.log('âœ… TÃ¬m tháº¥y nÃºt signup:', signupButton);
                    signupButton.click();
                    await new Promise(resolve => setTimeout(resolve, 2000));
                } else {
                    console.log('âŒ KhÃ´ng tÃ¬m tháº¥y nÃºt signup');
                    // List all buttons and links for debugging
                    const allButtons = document.querySelectorAll('button, a');
                    console.log('ğŸ“‹ Táº¥t cáº£ buttons/links:', Array.from(allButtons).map(el => ({
                        tag: el.tagName,
                        text: el.textContent?.trim(),
                        href: el.href,
                        onClick: el.onclick?.toString()
                    })));
                }
                
                // Check if we're on signup page
                const emailInput = document.querySelector('input[type="email"]') ||
                                 document.querySelector('input[name="email"]') ||
                                 document.querySelector('[data-testid="email-input"]');
                
                const passwordInput = document.querySelector('input[type="password"]') ||
                                    document.querySelector('input[name="password"]') ||
                                    document.querySelector('[data-testid="password-input"]');
                
                if (emailInput && passwordInput) {
                    console.log('âœ… ÄÃ£ vÃ o signup page - cÃ³ email vÃ  password input');
                    
                    // Fill test data
                    emailInput.value = 'test.signup.' + Date.now() + '@sabohub.com';
                    passwordInput.value = 'TestPassword123!';
                    
                    // Trigger input events
                    emailInput.dispatchEvent(new Event('input', { bubbles: true }));
                    passwordInput.dispatchEvent(new Event('input', { bubbles: true }));
                    
                    console.log('âœ… ÄÃ£ Ä‘iá»n thÃ´ng tin test');
                    
                    // Find submit button
                    const submitButton = document.querySelector('button[type="submit"]') ||
                                       document.querySelector('button:contains("ÄÄƒng kÃ½")') ||
                                       document.querySelector('button:contains("Sign Up")') ||
                                       document.querySelector('[data-testid="signup-submit"]');
                    
                    if (submitButton) {
                        console.log('âœ… TÃ¬m tháº¥y nÃºt submit:', submitButton);
                        
                        // Monitor network requests
                        const originalFetch = window.fetch;
                        window.fetch = function(...args) {
                            console.log('ğŸŒ Network request:', args[0]);
                            return originalFetch.apply(this, args)
                                .then(response => {
                                    console.log('ğŸ“¡ Response status:', response.status);
                                    if (!response.ok) {
                                        console.error('âŒ Network error:', response.status, response.statusText);
                                    }
                                    return response;
                                })
                                .catch(error => {
                                    console.error('âŒ Fetch error:', error);
                                    throw error;
                                });
                        };
                        
                        // Click submit
                        submitButton.click();
                        console.log('ğŸš€ ÄÃ£ click submit, chá» response...');
                        
                        // Wait and check for results
                        await new Promise(resolve => setTimeout(resolve, 5000));
                        
                        // Check for success/error messages
                        const messages = document.querySelectorAll('.snackbar, .toast, .alert, .notification, [role="alert"]');
                        if (messages.length > 0) {
                            console.log('ğŸ“¢ Messages found:', Array.from(messages).map(el => el.textContent));
                        } else {
                            console.log('ğŸ“­ KhÃ´ng cÃ³ thÃ´ng bÃ¡o nÃ o');
                        }
                        
                    } else {
                        console.log('âŒ KhÃ´ng tÃ¬m tháº¥y nÃºt submit');
                    }
                    
                } else {
                    console.log('âŒ KhÃ´ng tÃ¬m tháº¥y form signup (thiáº¿u email hoáº·c password input)');
                }
                
            } catch (error) {
                console.error('ğŸ’¥ Lá»—i khi test:', error);
            }
        }
        
        // Monitor console for Supabase errors
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            if (args.some(arg => typeof arg === 'string' && arg.includes('supabase'))) {
                originalLog('ğŸ” SUPABASE LOG:', ...args);
            }
            return originalLog.apply(this, args);
        };
        
        console.error = function(...args) {
            if (args.some(arg => typeof arg === 'string' && (arg.includes('supabase') || arg.includes('500')))) {
                originalLog('ğŸš¨ SUPABASE ERROR:', ...args);
            }
            return originalError.apply(this, args);
        };
        
        // Start test when page loads
        window.addEventListener('load', () => {
            setTimeout(testSignupFlow, 1000);
        });
    </script>
</head>
<body>
    <h1>ğŸ§ª SABOHUB Signup Flow Test</h1>
    <p>Má»Ÿ Console (F12) Ä‘á»ƒ xem káº¿t quáº£ test...</p>
    <p>Script sáº½ tá»± Ä‘á»™ng:</p>
    <ul>
        <li>âœ… TÃ¬m nÃºt signup</li>
        <li>âœ… Navigate Ä‘áº¿n signup page</li>
        <li>âœ… Äiá»n thÃ´ng tin test</li>
        <li>âœ… Submit form</li>
        <li>âœ… Monitor network requests</li>
        <li>âœ… Check error messages</li>
    </ul>
    
    <div id="results"></div>
    
    <script>
        // Redirect to main app after showing instructions
        setTimeout(() => {
            window.location.href = 'http://localhost:58769';
        }, 3000);
    </script>
</body>
</html>